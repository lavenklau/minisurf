#include "Config.h"
#include "Quadrature.h"

namespace msf {

	// precise of order 3
	Real STRANG3_weight[4] = { -0.56250000000000000000,0.52083333333333333333,0.52083333333333333333,0.520833333333333333331 };
	Real STRANG3_uv[4][2] = {
		{0.33333333333333333333, 0.33333333333333333333}, {0.60000000000000000000, 0.20000000000000000000},
		{0.20000000000000000000, 0.60000000000000000000}, {0.20000000000000000000, 0.20000000000000000000} };

	// precision of order 5
	Real STRANG7_weight[7] = { 0.22500000000000000,0.12593918054482717,0.12593918054482717,0.12593918054482717,0.13239415278850616,0.13239415278850616,0.13239415278850616 };
	Real STRANG7_uv[7][2] = {
		{0.33333333333333333, 0.33333333333333333}, {0.79742698535308720, 0.10128650732345633}, {0.10128650732345633, 0.79742698535308720},
		{0.10128650732345633, 0.10128650732345633}, {0.05971587178976981, 0.47014206410511505}, {0.47014206410511505, 0.05971587178976981},
		{0.47014206410511505, 0.47014206410511505}
	};

	// precision of order 7
	Real STRANG10_uv[13][2] = { {0.333333333333333, 0.333333333333333},
	{0.479308067841923, 0.260345966079038}, {0.260345966079038, 0.479308067841923}, {0.260345966079038, 0.260345966079038}, {0.869739794195568, 0.065130102902216},
	{0.065130102902216, 0.869739794195568}, {0.065130102902216, 0.065130102902216}, {0.638444188569809, 0.312865496004875}, {0.638444188569809, 0.048690315425316},
	{0.312865496004875, 0.638444188569809}, {0.312865496004875, 0.048690315425316}, {0.048690315425316, 0.638444188569809}, {0.048690315425316, 0.312865496004875},
	};
	Real STRANG10_w[13] = { -0.149570044467670, 0.175615257433204,
		  0.175615257433204, 0.175615257433204, 0.053347235608839, 0.053347235608839,
		  0.053347235608839, 0.077113760890257, 0.077113760890257, 0.077113760890257,
		  0.077113760890257, 0.077113760890257, 0.077113760890257 };

	// precision of order 8
	Real TOMS584_uv[19][2] = { {0.3333333333333333, 0.3333333333333333}, {0.7974269853530872, 0.1012865073234563},
	{0.1012865073234563, 0.7974269853530872}, {0.1012865073234563, 0.1012865073234563}, {0.0597158717897698, 0.4701420641051151}, {0.4701420641051151, 0.0597158717897698},
	{0.4701420641051151, 0.4701420641051151}, {0.5357953464498992, 0.2321023267750504}, {0.2321023267750504, 0.5357953464498992}, {0.2321023267750504, 0.2321023267750504},
	{0.9410382782311209, 0.0294808608844396}, {0.0294808608844396, 0.9410382782311209}, {0.0294808608844396, 0.0294808608844396}, {0.7384168123405100, 0.2321023267750504},
	{0.7384168123405100, 0.0294808608844396}, {0.2321023267750504, 0.7384168123405100}, {0.2321023267750504, 0.0294808608844396}, {0.0294808608844396, 0.7384168123405100},
	{0.0294808608844396, 0.2321023267750504}
	};
	Real TOMS584_w[19] = { 0.0378610912003147, 0.0376204254131829,
  0.0376204254131829, 0.0376204254131829, 0.0783573522441174, 0.0783573522441174,
  0.0783573522441174, 0.1162714796569659, 0.1162714796569659, 0.1162714796569659,
  0.0134442673751655, 0.0134442673751655, 0.0134442673751655, 0.0375097224552317,
  0.0375097224552317, 0.0375097224552317, 0.0375097224552317, 0.0375097224552317,
  0.0375097224552317
	};

	// precision of order 9
	Real TOMS612_19uv[19][2] = { {0.33333333333333331, 0.33333333333333331}, {2.06349616025259287E-002,  0.48968251919873701},
	{0.48968251919873701, 2.06349616025259287E-002}, {0.48968251919873701, 0.48968251919873701}, {0.12582081701412900, 0.43708959149293553}, {0.43708959149293553, 0.12582081701412900},
	{0.43708959149293553, 0.43708959149293553}, {0.62359292876193562, 0.18820353561903219}, {0.18820353561903219, 0.62359292876193562}, {0.18820353561903219, 0.18820353561903219},
	{0.91054097321109406, 4.47295133944529688E-002}, {4.47295133944529688E-002, 0.91054097321109406}, {4.47295133944529688E-002, 4.47295133944529688E-002}, {0.74119859878449801, 3.68384120547362581E-002},
	{0.74119859878449801, 0.22196298916076573}, {3.68384120547362581E-002, 0.74119859878449801}, {3.68384120547362581E-002, 0.22196298916076573}, {0.22196298916076573,      0.74119859878449801},
	{0.22196298916076573, 3.68384120547362581E-002}
	};
	Real TOMS612_19w[19] = { 9.71357962827961025E-002, 3.13347002271398278E-002,
  3.13347002271398278E-002, 3.13347002271398278E-002, 7.78275410047754301E-002, 7.78275410047754301E-002,
  7.78275410047754301E-002, 7.96477389272090969E-002, 7.96477389272090969E-002, 7.96477389272090969E-002,
  2.55776756586981006E-002, 2.55776756586981006E-002, 2.55776756586981006E-002, 4.32835393772893970E-002,
  4.32835393772893970E-002, 4.32835393772893970E-002, 4.32835393772893970E-002, 4.32835393772893970E-002,
  4.32835393772893970E-002
	};

	// precision of order 11
	Real TOMS612_28uv[28][2] = { {0.33333333333333333,  0.333333333333333333}, {0.9480217181434233,   0.02598914092828833},
  {0.02598914092828833,  0.9480217181434233}, {0.02598914092828833,  0.02598914092828833}, {0.8114249947041546,   0.09428750264792270}, {0.09428750264792270,  0.8114249947041546},
  {0.09428750264792270,  0.09428750264792270}, {0.01072644996557060,  0.4946367750172147}, {0.4946367750172147,   0.01072644996557060}, {0.4946367750172147,   0.4946367750172147},
  {0.5853132347709715,   0.2073433826145142}, {0.2073433826145142,   0.5853132347709715}, {0.2073433826145142,   0.2073433826145142}, {0.1221843885990187,   0.4389078057004907},
  {0.4389078057004907,   0.1221843885990187}, {0.4389078057004907,   0.4389078057004907}, {0.6779376548825902,   0.04484167758913055}, {0.6779376548825902,   0.27722066752827925},
  {0.04484167758913055,  0.6779376548825902}, {0.04484167758913055,  0.27722066752827925}, {0.27722066752827925,  0.6779376548825902}, {0.27722066752827925,  0.04484167758913055},
  {0.8588702812826364,   0.00000000000000000}, {0.8588702812826364,   0.1411297187173636}, {0.0000000000000000,   0.8588702812826364}, {0.0000000000000000,   0.1411297187173636},
  {0.1411297187173636,   0.8588702812826364}, {0.1411297187173636,   0.0000000000000000},
	};
	Real TOMS612_28w[28] = { 0.08797730116222190, 0.008744311553736190,
				0.008744311553736190, 0.008744311553736190, 0.03808157199393533, 0.03808157199393533,
				0.03808157199393533, 0.01885544805613125, 0.01885544805613125, 0.01885544805613125,
				0.07215969754474100, 0.07215969754474100, 0.07215969754474100, 0.06932913870553720,
				0.06932913870553720, 0.06932913870553720, 0.04105631542928860, 0.04105631542928860,
				0.04105631542928860, 0.04105631542928860, 0.04105631542928860, 0.04105631542928860,
				0.007362383783300573, 0.007362383783300573, 0.007362383783300573, 0.007362383783300573,
				0.007362383783300573, 0.007362383783300573
	};

	Real TOMS706_uv[37][2] = { {0.333333333333333333333333333333, 0.333333333333333333333333333333}, {0.950275662924105565450352089520, 0.024862168537947217274823955239},
	{0.024862168537947217274823955239, 0.950275662924105565450352089520}, {0.024862168537947217274823955239, 0.024862168537947217274823955239}, {0.171614914923835347556304795551, 0.414192542538082326221847602214}, {0.414192542538082326221847602214, 0.171614914923835347556304795551},
	{0.414192542538082326221847602214, 0.414192542538082326221847602214}, {0.539412243677190440263092985511, 0.230293878161404779868453507244}, {0.230293878161404779868453507244, 0.539412243677190440263092985511}, {0.230293878161404779868453507244, 0.230293878161404779868453507244},
	{0.772160036676532561750285570113, 0.113919981661733719124857214943}, {0.113919981661733719124857214943, 0.772160036676532561750285570113}, {0.113919981661733719124857214943, 0.113919981661733719124857214943}, {0.009085399949835353883572964740, 0.495457300025082323058213517632},
	{0.495457300025082323058213517632, 0.009085399949835353883572964740}, {0.495457300025082323058213517632, 0.495457300025082323058213517632}, {0.062277290305886993497083640527, 0.468861354847056503251458179727}, {0.468861354847056503251458179727, 0.062277290305886993497083640527},
	{0.468861354847056503251458179727, 0.468861354847056503251458179727}, {0.022076289653624405142446876931, 0.851306504174348550389457672223}, {0.022076289653624405142446876931, 0.126617206172027096933163647918}, {0.851306504174348550389457672223, 0.022076289653624405142446876931},
	{0.851306504174348550389457672223, 0.126617206172027096933163647918}, {0.126617206172027096933163647918, 0.022076289653624405142446876931}, {0.126617206172027096933163647918, 0.851306504174348550389457672223}, {0.018620522802520968955913511549, 0.689441970728591295496647976487},
	{0.018620522802520968955913511549, 0.291937506468887771754472382212}, {0.689441970728591295496647976487, 0.018620522802520968955913511549}, {0.689441970728591295496647976487, 0.291937506468887771754472382212}, {0.291937506468887771754472382212, 0.018620522802520968955913511549},
	{0.291937506468887771754472382212, 0.689441970728591295496647976487}, {0.096506481292159228736516560903, 0.635867859433872768286976979827}, {0.096506481292159228736516560903, 0.267625659273967961282458816185}, {0.635867859433872768286976979827, 0.096506481292159228736516560903},
	{0.635867859433872768286976979827, 0.267625659273967961282458816185}, {0.267625659273967961282458816185, 0.096506481292159228736516560903}, {0.267625659273967961282458816185, 0.635867859433872768286976979827}
	};

	Real TOMS706_w[37] = { 0.051739766065744133555179145422, 0.008007799555564801597804123460, 0.008007799555564801597804123460, 0.008007799555564801597804123460,
  0.046868898981821644823226732071, 0.046868898981821644823226732071, 0.046868898981821644823226732071, 0.046590940183976487960361770070,
  0.046590940183976487960361770070, 0.046590940183976487960361770070, 0.031016943313796381407646220131, 0.031016943313796381407646220131,
  0.031016943313796381407646220131, 0.010791612736631273623178240136, 0.010791612736631273623178240136, 0.010791612736631273623178240136,
  0.032195534242431618819414482205, 0.032195534242431618819414482205, 0.032195534242431618819414482205, 0.015445834210701583817692900053,
  0.015445834210701583817692900053, 0.015445834210701583817692900053, 0.015445834210701583817692900053, 0.015445834210701583817692900053,
  0.015445834210701583817692900053, 0.017822989923178661888748319485, 0.017822989923178661888748319485, 0.017822989923178661888748319485,
  0.017822989923178661888748319485, 0.017822989923178661888748319485, 0.017822989923178661888748319485, 0.037038683681384627918546472190,
  0.037038683681384627918546472190, 0.037038683681384627918546472190, 0.037038683681384627918546472190, 0.037038683681384627918546472190,
  0.037038683681384627918546472190
	};

	std::tuple<Real(*)[2], Real*, int> getTriQuadrature(int order) {
		if (order < 3) {
			return { STRANG3_uv,STRANG3_weight, sizeof(STRANG3_weight) / sizeof(Real) };
		}
		else if (order < 5) {
			return { STRANG7_uv,STRANG7_weight, sizeof(STRANG7_weight) / sizeof(Real) };
		}
		else if (order < 7) {
			return { STRANG10_uv,STRANG10_w, sizeof(STRANG10_w) / sizeof(Real) };
		}
		else if (order < 9) {
			return { TOMS584_uv,TOMS584_w, sizeof(TOMS584_w) / sizeof(Real) };
		}
		else if (order < 11) {
			return { TOMS612_28uv, TOMS612_28w, sizeof(TOMS612_28w) / sizeof(Real) };
		}
		else {
			return { TOMS706_uv, TOMS706_w, sizeof(TOMS706_w) / sizeof(Real) };
		}
	}

}

